<%- include('../partials/_header') %>

<main class="container mx-auto my-12 px-4">
    <div class="max-w-4xl mx-auto">
        <h1 class="text-3xl font-bold text-gray-900 dark:text-white mb-2">My Profile</h1>
        <p class="text-lg text-gray-600 dark:text-gray-400 mb-8">Welcome, <%= user.name %>!</p>

        <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md">
            <h2 class="text-2xl font-semibold text-gray-800 dark:text-white mb-4">My Uploaded Files</h2>
            
            <% if (user.uploadedFiles && user.uploadedFiles.length > 0) { %>
                <div class="space-y-4">
                    <% user.uploadedFiles.forEach(file => { %>
                        <div class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-md">
                            <div class="flex-grow">
                                <a href="<%= file.url %>" target="_blank" rel="noopener noreferrer" class="text-blue-600 dark:text-blue-400 hover:underline font-medium break-all">
                                    <%= file.fileName %>
                                </a>
                                <p class="text-sm text-gray-500 dark:text-gray-400">
                                    Uploaded on <%= new Date(file.createdAt).toLocaleDateString() %>
                                </p>
                            </div>
                            <form action="/profile/files/<%= file.id %>?_method=DELETE" method="POST" class="ml-4" onsubmit="return confirm('Are you sure you want to delete this file? This cannot be undone.');">
                                <button type="submit" class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-3 rounded-md text-sm transition-colors">
                                    Delete
                                </button>
                            </form>
                        </div>
                    <% }) %>
                </div>
            <% } else { %>
                <p class="text-gray-500 dark:text-gray-400">You haven't uploaded any files yet.</p>
            <% } %>
        </div>
    </div>
</main>

<%- include('../partials/_footer') %>
