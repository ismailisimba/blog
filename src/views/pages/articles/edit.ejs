<%- include('../../partials/_header', { user: user }) %>

<div class="max-w-4xl mx-auto bg-white p-8 rounded-lg shadow-md">
  <h2 class="text-3xl font-bold mb-6">Edit Article</h2>
  
  <%# The form action now points to the update route with the method override %>
  <form action="/articles/<%= article.slug %>?_method=PUT" method="POST" class="space-y-6">
    <div>
      <label for="title" class="block text-sm font-medium text-gray-700">Title</label>
      <%# Pre-populate the value attribute %>
      <input type="text" name="title" id="title" required value="<%= article.title %>" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary">
    </div>
    
    <%# Note: We are not including the file upload on the edit page for simplicity. %>
    <%# Adding "edit image" functionality requires more complex logic. %>

    <div>
      <label for="content" class="block text-sm font-medium text-gray-700">Content</label>
      <%# Pre-populate the content between the textarea tags %>
      <textarea name="content" id="markdown-editor"><%= article.content %></textarea>
    </div>
    
    <button type="submit" name="action" value="publish" class="w-full flex justify-center py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 ">Publish Article</button>
  <button type="submit" name="action" value="save_draft" class="w-full flex justify-center py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50">
    Save as Draft
  </button>
  </form>
</div>

<script>
  // Initialize the editor
  const easyMDE = new EasyMDE({element: document.getElementById('markdown-editor')});
</script>

<%- include('../../partials/_footer') %>
